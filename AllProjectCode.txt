### FILE: src\main\java\com\weavers\config\ConfigReader.java
package com.weavers.config;

import java.io.FileInputStream;
import java.io.IOException;
import java.util.Properties;

public class ConfigReader {
    private static final Properties properties = new Properties();
    private static final String CONFIG_FILE_PATH = System.getProperty("config.file", "src/test/resources/config.properties");

    static {
        try (FileInputStream fis = new FileInputStream(CONFIG_FILE_PATH)){
            properties.load(fis);
        } catch (IOException e) {
            throw new RuntimeException("Failed to load config.properties file");
        }
    }

    public static String getBaseUrl() {
        return properties.getProperty("BASE_URL");
    }
    public static String getApiVersion() {
        return properties.getProperty("API_VERSION");
    }
    public static String getAuthServices() { return properties.getProperty("AUTH_SERVICES"); }


    public static String getLoginEndpoint() { return properties.getProperty("LOGIN_ENDPOINT");}
    public static String getRegisterEndpoint() {
        return properties.getProperty("REGISTER_ENDPOINT");
    }
    public static String getRequestOTP() {
        return properties.getProperty("REQUEST_OTP_ENDPOINT");
    }


    public static String getLoginTestDataPath() { return properties.getProperty("LOGIN_TEST_DATA_PATH");}
    public static String getRegisterANewUserTestDataPath() { return properties.getProperty("REGISTER_A_NEW_USER_DATA_PATH");}
    public static String getRequestOTPDataPath() { return properties.getProperty("REQUEST_OTP_TEST_DATA_PATH");}
}

---

### FILE: src\main\java\com\weavers\endpoints\Routes.java
package com.weavers.endpoints;

import com.weavers.config.ConfigReader;

public class Routes {

        private static final String BASE_URI = ConfigReader.getBaseUrl();
        private static final String API_VERSION = ConfigReader.getApiVersion();
        private static final String AUTH_SERVICE = ConfigReader.getAuthServices();

        private static final String AUTH_BASE_PATH = BASE_URI + "/" + API_VERSION + "/" + AUTH_SERVICE;

        public static final String LOGIN_URI = AUTH_BASE_PATH + ConfigReader.getLoginEndpoint();
        public static final String REGISTER_URI = AUTH_BASE_PATH + ConfigReader.getRegisterEndpoint();
        public static final String REQUEST_OTP_URI = AUTH_BASE_PATH + ConfigReader.getRequestOTP();
}

---

### FILE: src\main\java\com\weavers\listeners\TestListener.java
package com.weavers.listeners;
import com.weavers.utils.LoggerUtils;
import org.testng.ITestContext;
import org.testng.ITestListener;
import org.testng.ITestResult;

public class TestListener implements ITestListener {

    @Override
    public void onStart(ITestContext context) {
        LoggerUtils.info("========================================");
        LoggerUtils.info("Test Suite Started: " + context.getName());
        LoggerUtils.info("========================================");
        
    }

    @Override
    public void onFinish(ITestContext context) {
        LoggerUtils.info("========================================");
        LoggerUtils.info("Test Suite Finished: " + context.getName());
        LoggerUtils.info("========================================");
       
    }

    @Override
    public void onTestStart(ITestResult result) {
        LoggerUtils.info("========================================");
        LoggerUtils.startTestCase(result.getMethod().getMethodName());
        LoggerUtils.info("========================================");
    }

    @Override
    public void onTestSuccess(ITestResult result) {
        LoggerUtils.info("Test Passed: " + result.getMethod().getMethodName());
        LoggerUtils.endTestCase(result.getMethod().getMethodName());
    }

    @Override
    public void onTestFailure(ITestResult result) {
        LoggerUtils.error("Test Failed: " + result.getMethod().getMethodName(), result.getThrowable());
        LoggerUtils.error("Reason: ", result.getThrowable());
        LoggerUtils.endTestCase(result.getMethod().getMethodName());
       
    }

    @Override
    public void onTestSkipped(ITestResult result) {
        LoggerUtils.warn("Test Skipped: " + result.getName());
        if (result.getThrowable() != null) {
            LoggerUtils.warn("Reason: " + result.getThrowable().getMessage());
        }
    }
}

---

### FILE: src\main\java\com\weavers\pojo\LoginAPI\request\LoginRequest.java
package com.weavers.pojo.LoginAPI.request;

import com.fasterxml.jackson.annotation.JsonProperty;

public class LoginRequest {
    
    @JsonProperty("email")
    private String email;
    
    @JsonProperty("password")
    private String password;
    
    @JsonProperty("role")
    private String role;

    // Constructors
    public LoginRequest() {
    }

    public LoginRequest(String email, String password, String role) {
        this.email = email;
        this.password = password;
        this.role = role;
    }

    // Getters and Setters
    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getPassword() {
        return password;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public String getRole() {
        return role;
    }

    public void setRole(String role) {
        this.role = role;
    }

    @Override
    public String toString() {
        return "LoginRequest{" +
                "email='" + email + '\'' +
                ", password='" + password + '\'' +
                ", role='" + role + '\'' +
                '}';
    }
}

---

### FILE: src\main\java\com\weavers\pojo\LoginAPI\response\LoginResponse.java
package com.weavers.pojo.LoginAPI.response;

import com.fasterxml.jackson.annotation.JsonIgnoreProperties;
import com.fasterxml.jackson.annotation.JsonProperty;

public class LoginResponse {

    @JsonProperty("code")
    private int code;

    @JsonProperty("message")
    private String message;

    @JsonProperty("data")
    private Data data;

    // Inner Classes
    
    public static class Data {
        @JsonProperty("user")
        private User user;

        @JsonProperty("token")
        private Token token;

        public User getUser() {
            return user;
        }

        public void setUser(User user) {
            this.user = user;
        }

        public Token getToken() {
            return token;
        }

        public void setToken(Token token) {
            this.token = token;
        }
    }
    @JsonIgnoreProperties(ignoreUnknown = true)
    public static class User {
        @JsonProperty("id")
        private String id;

        @JsonProperty("fullName")
        private String fullName;

        // @JsonProperty("lastName")
        // private String lastName;

        @JsonProperty("email")
        private String email;

        @JsonProperty("phone")
        private String phone;

        @JsonProperty("isBlocked")
        private boolean isBlocked;

        @JsonProperty("isVerified")
        private boolean isVerified;

        @JsonProperty("role")
        private Role role;

        @JsonProperty("address")
        private Address address;

        @JsonProperty("profileImage")
        public String profileImage;

        

        // Getters and Setters
        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }

        public String getFirstName() {
            return fullName;
        }

        public void setFirstName(String firstName) {
            this.fullName = firstName;
        }

        // public String getLastName() {
        //     return lastName;
        // }

        // public void setLastName(String lastName) {
        //     this.lastName = lastName;
        // }

        public String getEmail() {
            return email;
        }

        public void setEmail(String email) {
            this.email = email;
        }

        public String getPhone() {
            return phone;
        }

        public void setPhone(String phone) {
            this.phone = phone;
        }

        public boolean isBlocked() {
            return isBlocked;
        }

        public void setBlocked(boolean blocked) {
            isBlocked = blocked;
        }

        public boolean isVerified() {
            return isVerified;
        }

        public void setVerified(boolean verified) {
            isVerified = verified;
        }

        public Role getRole() {
            return role;
        }

        public void setRole(Role role) {
            this.role = role;
        }

        public Address getAddress() {
            return address;
        }

        public void setAddress(Address address) {
            this.address = address;
        }

        public String getProfileImage() {
            return profileImage;
        }

        public void setProfileImage(String profileImage) {
            this.profileImage = profileImage;
        }
    }
    @JsonIgnoreProperties(ignoreUnknown = true)
    public static class Role {
        @JsonProperty("id")
        private String id;

        @JsonProperty("name")
        private String name;

        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }

        public String getName() {
            return name;
        }

        public void setName(String name) {
            this.name = name;
        }
    }
@JsonIgnoreProperties(ignoreUnknown = true)
    public static class Address {
        @JsonProperty("id")
        private String id;

        @JsonProperty("country")
        private String country;

        @JsonProperty("state")
        private String state;

        @JsonProperty("city")
        private String city;

        @JsonProperty("zipCode")
        private String zipCode;

        public String getId() {
            return id;
        }

        public void setId(String id) {
            this.id = id;
        }

        public String getCountry() {
            return country;
        }

        public void setCountry(String country) {
            this.country = country;
        }

        public String getState() {
            return state;
        }

        public void setState(String state) {
            this.state = state;
        }

        public String getCity() {
            return city;
        }

        public void setCity(String city) {
            this.city = city;
        }

        public String getZipCode() {
            return zipCode;
        }

        public void setZipCode(String zipCode) {
            this.zipCode = zipCode;
        }
    }
@JsonIgnoreProperties(ignoreUnknown = true)
    public static class Token {
        @JsonProperty("access")
        private String access;

        @JsonProperty("refresh")
        private String refresh;

        public String getAccess() {
            return access;
        }

        public void setAccess(String access) {
            this.access = access;
        }

        public String getRefresh() {
            return refresh;
        }

        public void setRefresh(String refresh) {
            this.refresh = refresh;
        }
    }

    // Main class Getters and Setters
    public int getCode() {
        return code;
    }

    public void setCode(int code) {
        this.code = code;
    }

    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }

    public Data getData() {
        return data;
    }

    public void setData(Data data) {
        this.data = data;
    }
}

---

### FILE: src\main\java\com\weavers\pojo\RegisterANewUserAPI\request\RegisterANewUserRequest.java
package com.weavers.pojo.RegisterANewUserAPI.request;

public class RegisterANewUserRequest {
    private String fullName;
    private String email;
    private String password;
    private String confirmPassword;
    private String token;
    private String role;

    // Default constructor
    public RegisterANewUserRequest() {
    }

    // Parameterized constructor
    public RegisterANewUserRequest(String fullName, String email, String password,
                            String confirmPassword, String token, String role) {
        this.fullName = fullName;
        this.email = email;
        this.password = password;
        this.confirmPassword = confirmPassword;
        this.token = token;
        this.role = role;
    }

    // Getters
    public String getFullName() {
        return fullName;
    }

    public String getEmail() {
        return email;
    }

    public String getPassword() {
        return password;
    }

    public String getConfirmPassword() {
        return confirmPassword;
    }

    public String getToken() {
        return token;
    }

    public String getRole() {
        return role;
    }

    // Setters
    public void setFullName(String fullName) {
        this.fullName = fullName;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public void setPassword(String password) {
        this.password = password;
    }

    public void setConfirmPassword(String confirmPassword) {
        this.confirmPassword = confirmPassword;
    }

    public void setToken(String token) {
        this.token = token;
    }

    public void setRole(String role) {
        this.role = role;
    }

    // toString method
    @Override
    public String toString() {
        return "UserRegistration{" +
                "fullName='" + fullName + '\'' +
                ", email='" + email + '\'' +
                ", password='[PROTECTED]'" +
                ", confirmPassword='[PROTECTED]'" +
                ", token='" + token + '\'' +
                ", role='" + role + '\'' +
                '}';
    }
}

---

### FILE: src\main\java\com\weavers\pojo\RegisterANewUserAPI\response\RegisterANewUserResponse.java
package com.weavers.pojo.RegisterANewUserAPI.response;

public class RegisterANewUserResponse {
    private int code;
    private String message;
    private Data data;

    // Default constructor
    public RegisterANewUserResponse() {
    }

    // Parameterized constructor
    public RegisterANewUserResponse(int code, String message, Data data) {
        this.code = code;
        this.message = message;
        this.data = data;
    }

    // Getters
    public int getCode() {
        return code;
    }

    public String getMessage() {
        return message;
    }

    public Data getData() {
        return data;
    }

    // Setters
    public void setCode(int code) {
        this.code = code;
    }

    public void setMessage(String message) {
        this.message = message;
    }

    public void setData(Data data) {
        this.data = data;
    }

    // toString method
    @Override
    public String toString() {
        return "ApiResponse{" +
                "code=" + code +
                ", message='" + message + '\'' +
                ", data=" + data +
                '}';
    }

    // Inner class for Data
    public static class Data {
        private String id;

        // Default constructor
        public Data() {
        }

        // Parameterized constructor
        public Data(String id) {
            this.id = id;
        }

        // Getter
        public String getId() {
            return id;
        }

        // Setter
        public void setId(String id) {
            this.id = id;
        }

        // toString method
        @Override
        public String toString() {
            return "Data{" +
                    "id='" + id + '\'' +
                    '}';
        }
    }
}

---

### FILE: src\main\java\com\weavers\pojo\RequestOTPAPI\request\RequestOTPRequest.java
package com.weavers.pojo.RequestOTPAPI.request;

public class RequestOTPRequest {

    private String email;

    public RequestOTPRequest() {}

    public RequestOTPRequest(String email) {
        this.email = email;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    @Override
    public String toString() {
        return "RequestOTPRequest{" + "email=" + email + '}';
    }
}

---

### FILE: src\main\java\com\weavers\pojo\RequestOTPAPI\response\RequestOTPResponse.java
package com.weavers.pojo.RequestOTPAPI.response;

public class RequestOTPResponse {

    private int code;
    private String message;
    private boolean data;

    public RequestOTPResponse() {}

    public RequestOTPResponse(int code, String message) {
        this.code = code;
        this.message = message;
    }

    public int getCode() {
        return code;
    }

    public void setCode(int code) {
        this.code = code;
    }

    public String getMessage() {
        return message;
    }

    public void setMessage(String message) {
        this.message = message;
    }

    public boolean isData() {
        return data;
    }

    public void setData(boolean data) {
        this.data = data;
    }
}

---

### FILE: src\main\java\com\weavers\services\AuthService.java
package com.weavers.services;

import com.weavers.endpoints.Routes;
import com.weavers.config.ConfigReader;
import com.weavers.pojo.LoginAPI.request.LoginRequest;
import com.weavers.pojo.LoginAPI.response.LoginResponse;
//import com.weavers.pojo.LoginAPI.response.LogoutResponse;
import com.weavers.pojo.RegisterANewUserAPI.request.RegisterANewUserRequest;
import com.weavers.pojo.RegisterANewUserAPI.response.RegisterANewUserResponse;
import com.weavers.pojo.RequestOTPAPI.request.RequestOTPRequest;
import com.weavers.pojo.RequestOTPAPI.response.RequestOTPResponse;
import com.weavers.utils.RestUtils;
import com.weavers.utils.TokenManager;
import io.restassured.response.Response;



public class AuthService {

    public static Response login(LoginRequest loginRequest) {
        return RestUtils.postRequest(Routes.LOGIN_URI, loginRequest);
    }

    public static Response wrongMethodLogin() {
        return RestUtils.getRequest(Routes.LOGIN_URI);
    }

    public static LoginResponse loginAndGetResponse(LoginRequest loginRequest) {
        Response response = login(loginRequest);
        return response.as(LoginResponse.class);
    }

    public static LoginResponse loginAndStoreToken(LoginRequest loginRequest) {
        LoginResponse loginResponse = loginAndGetResponse(loginRequest);
        TokenManager.getInstance().setTokens(loginResponse);
        System.out.println("Login successful and tokens stored for reuse");
        return loginResponse;
    }

    public static Response registerNewUser(RegisterANewUserRequest registerANewUserRequest) {
        return RestUtils.postRequest(Routes.REGISTER_URI, registerANewUserRequest);
    }

    public static RegisterANewUserResponse RegisterANewUserAndGetResponse(RegisterANewUserRequest registerANewUserRequest) {
        Response response = registerNewUser(registerANewUserRequest);
        return response.as(RegisterANewUserResponse.class);
    }

    public static Response requestOTP(RequestOTPRequest requestOTPRequest) {
        return RestUtils.postRequest(Routes.REQUEST_OTP_URI, requestOTPRequest);
    }

    public static RequestOTPResponse RequestOTPAndGetResponse(RequestOTPRequest requestOTPRequest) {
        Response response = requestOTP(requestOTPRequest);
        return response.as(RequestOTPResponse.class);
    }

    public static String getAccessToken(LoginResponse loginResponse) {
        return loginResponse.getData().getToken().getAccess();
    }

    public static String getRefreshToken(LoginResponse loginResponse) {
        return loginResponse.getData().getToken().getRefresh();
    }
}

---

### FILE: src\main\java\com\weavers\utils\JsonUtils.java
package com.weavers.utils;

import com.fasterxml.jackson.databind.ObjectMapper;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;

import java.io.FileReader;
import java.io.IOException;

public class JsonUtils {

    private static final ObjectMapper objectMapper = new ObjectMapper();

    public static JSONArray readJsonArray(String filePath) {
        JSONParser parser = new JSONParser();
        try {
            Object obj = parser.parse(new FileReader(filePath));
            return (JSONArray) obj;
        } catch (Exception e) {
            throw new RuntimeException("Failed to read JSON file: " + filePath);
        }
    }

    public static JSONObject readJsonObject(String filePath) {
        JSONParser parser = new JSONParser();
        try {
            Object obj = parser.parse(new FileReader(filePath));
            return (JSONObject) obj;
        } catch (Exception e) {
            throw new RuntimeException("Failed to read JSON file: " + filePath);
        }
    }

    public static String toJsonString(Object obj) {
        try {
            return objectMapper.writeValueAsString(obj);
        } catch (IOException e) {
            throw new RuntimeException("Failed to convert object to JSON string");
        }
    }

    public static <T> T fromJsonString(String jsonString, Class<T> clazz) {
        try {
            return objectMapper.readValue(jsonString, clazz);
        } catch (IOException e) {
            throw new RuntimeException("Failed to convert JSON string to object");
        }
    }
    
    public static JSONObject getJsonObjectFromArray(JSONArray jsonArray, int index) {
        if (jsonArray != null && index < jsonArray.size()) {
            return (JSONObject) jsonArray.get(index);
        }
        throw new RuntimeException("Invalid index or null array");
    }
}

---

### FILE: src\main\java\com\weavers\utils\LoggerUtils.java
package com.weavers.utils;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.ThreadContext;

public class LoggerUtils {
    private static final Logger logger = LogManager.getLogger();

    public static void info(String message) {
        logger.info(message);
    }

    public static void warn(String message) {
        logger.warn(message);
    }

    public static void error(String message) {
        logger.error(message);
    }

    public static void error(String message, Throwable throwable) {
        logger.error(message);
    }

    public static void debug(String message) {
        logger.debug(message);
    }

    public static void startTestCase(String testName) {

        ThreadContext.put("testName", testName);
        logger.info("========================================");
        logger.info("STARTING TEST: {}", testName);
        logger.info("========================================");
    }

    public static void endTestCase(String testName) {
        logger.info("****************************************************************");
        logger.info("END OF TEST: {}", testName);
        logger.info("****************************************************************");

        ThreadContext.remove("testName");
    }
}

---

### FILE: src\main\java\com\weavers\utils\MyRetry.java
package com.weavers.utils;

import org.testng.IRetryAnalyzer;
import org.testng.ITestResult;

public class MyRetry implements IRetryAnalyzer {

    private int retryCount = 0;
    private static final int maxRetryCount = 3;

    @Override
    public boolean retry(ITestResult result) {
        if (retryCount < maxRetryCount) {
            retryCount++;
            return true;
        }
        return false;
    }
}

---

### FILE: src\main\java\com\weavers\utils\RestUtils.java
package com.weavers.utils;

import io.restassured.RestAssured;
import io.restassured.http.ContentType;
import io.restassured.response.Response;
import io.restassured.specification.RequestSpecification;

import java.util.Map;

public class RestUtils {

    public static RequestSpecification getBaseRequest() {
        return RestAssured.given()
                .contentType(ContentType.JSON)
                .accept(ContentType.JSON)
                .log().all();
    }

    public static Response getRequest(String endpoint) {
        return getBaseRequest()
                .when()
                .get(endpoint)
                .then()
                .log().all()
                .extract()
                .response();
    }

    public static Response getRequest(String endpoint, Map<String, String> headers) {
        return getBaseRequest()
                .headers(headers)
                .when()
                .get(endpoint)
                .then()
                .log().all()
                .extract()
                .response();
    }

    public static Response postRequest(String endpoint, Object body) {
        return getBaseRequest()
                .body(body)
                .when()
                .post(endpoint)
                .then()
                .log().all()
                .extract()
                .response();
    }

    public static Response postRequest(String endpoint, Object body, Map<String, String> headers) {
        return getBaseRequest()
                .headers(headers)
                .body(body)
                .when()
                .post(endpoint)
                .then()
                .log().all()
                .extract()
                .response();
    }

    public static Response putRequest(String endpoint, Object body, Map<String, String> headers) {
        return getBaseRequest()
                .headers(headers)
                .body(body)
                .when()
                .put(endpoint)
                .then()
                .log().all()
                .extract()
                .response();
    }

    public static Response deleteRequest(String endpoint, Map<String, String> headers) {
        return getBaseRequest()
                .headers(headers)
                .when()
                .delete(endpoint)
                .then()
                .log().all()
                .extract()
                .response();
    }

    public static Map<String, String> getBearerTokenHeader(String token) {
        return Map.of("Authorization", "Bearer " + token);
        
    }
}

---

### FILE: src\main\java\com\weavers\utils\TokenManager.java
package com.weavers.utils;

import com.weavers.pojo.LoginAPI.response.LoginResponse;


public class TokenManager {

    private static TokenManager instance;
    private final ThreadLocal<String> accessToken = new ThreadLocal<>();
    private final ThreadLocal<String> refreshToken = new ThreadLocal<>();
    private final ThreadLocal<LoginResponse> loginResponse = new ThreadLocal<>();
    private final ThreadLocal<Long> tokenCreatedTime = new ThreadLocal<>();

    private TokenManager() {
    }

    public static synchronized TokenManager getInstance() {
        if (instance == null) {
            instance = new TokenManager();
        }
        return instance;
    }

    public void setTokens(LoginResponse response) {
        // Store the full response object
        this.loginResponse.set(response);

        if (response != null && response.getData() != null && response.getData().getToken() != null) {
            // Store specific tokens
            this.accessToken.set(response.getData().getToken().getAccess());
            this.refreshToken.set(response.getData().getToken().getRefresh());
            this.tokenCreatedTime.set(System.currentTimeMillis());

            LoggerUtils.info("===== Tokens stored in TokenManager for Thread: " + Thread.currentThread().getId()+" =====");        } else {
            LoggerUtils.error("===== Failed to store tokens: LoginResponse or Data was null =====");
        }
    }

    public void setTokens(String access, String refresh) {
        this.accessToken.set(access);
        this.refreshToken.set(refresh);
        this.tokenCreatedTime.set(System.currentTimeMillis());
        LoggerUtils.info("✓ Tokens manually stored for Thread: " + Thread.currentThread().getId());
    }

    public String getAccessToken() {
        if (accessToken.get() == null) {
            LoggerUtils.error("===== Access Token is missing in TokenManager. =====");
            // Optionally throw exception if you want to fail fast
            // throw new RuntimeException("Access Token is not available.");
        }
        return accessToken.get();
    }

    public String getRefreshToken() {
        if (refreshToken.get() == null) {
            LoggerUtils.warn("===== Refresh Token requested but not found. =====");
        }
        return refreshToken.get();
    }

    public LoginResponse getLoginResponse() {
        return loginResponse.get();
    }

    public boolean hasToken() {
        return accessToken.get() != null && !accessToken.get().isEmpty();
    }

    public boolean isTokenExpired(long durationInMillis) {
        if (!hasToken()) {
            LoggerUtils.debug("===== Check failed: No token found in manager. =====");
            return true;
        }

        if (tokenCreatedTime.get() == null) {
            return true;
        }

        long currentTime = System.currentTimeMillis();
        long diff = currentTime - tokenCreatedTime.get();

        LoggerUtils.debug("===== Token Age: " + diff + "ms | Max Duration: " + durationInMillis + "ms" + " =====");

        return diff > durationInMillis;
    }

    public void clearTokens() {
        accessToken.remove();
        refreshToken.remove();
        loginResponse.remove();
        tokenCreatedTime.remove();

        LoggerUtils.info("===== Tokens cleared from TokenManager =====");
    }

    public String getBearerTokenHeader() {
        return "Bearer " + getAccessToken();
    }

    public void printTokenInfo() {
        String access = accessToken.get();
        String refresh = refreshToken.get();

        LoggerUtils.debug("===== Token Info (Thread " + Thread.currentThread().getId() + ") =====");
        LoggerUtils.debug("Access Token: " + (access != null ? access.substring(0, Math.min(10, access.length())) + "..." : "null"));
        LoggerUtils.debug("Refresh Token: " + (refresh != null ? refresh.substring(0, Math.min(10, refresh.length())) + "..." : "null"));
        LoggerUtils.debug("Has Token: " + hasToken());
        LoggerUtils.debug("==================================");
    }
}

---

### FILE: src\test\java\com\weavers\base\BaseTest.java
package com.weavers.base;

import com.weavers.config.ConfigReader;
import io.restassured.RestAssured;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.BeforeMethod;

import java.lang.reflect.Method;

public class BaseTest {

    @BeforeClass
    public void setupBaseUrl() {
        RestAssured.baseURI = ConfigReader.getBaseUrl();
        System.out.println("=== Base URL Set: " + RestAssured.baseURI + " ===");
    }

    @BeforeMethod
    public void beforeMethod(Method method) {
        System.out.println("========================================");
        System.out.println("Starting Test: " + method.getName());
        System.out.println("========================================");
    }
}

---

### FILE: src\test\java\com\weavers\dataprovider\LoginAPI\loginApiTestDataProvider.java
package com.weavers.dataprovider.LoginAPI;

import com.weavers.config.ConfigReader;
import com.weavers.pojo.LoginAPI.request.LoginRequest;
import com.weavers.utils.JsonUtils;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.testng.annotations.DataProvider;

public class loginApiTestDataProvider {

    @DataProvider(name = "loginData")
    public Object[][] getLoginData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "loginData.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        Object[][] data = new Object[loginArray.size()][1];

        for (int i = 0; i < loginArray.size(); i++) {
            JSONObject loginObj = (JSONObject) loginArray.get(i);

            LoginRequest loginRequest = new LoginRequest();
            loginRequest.setEmail((String) loginObj.get("email"));
            loginRequest.setPassword((String) loginObj.get("password"));
            loginRequest.setRole((String) loginObj.get("role"));

            data[i][0] = loginRequest;
        }

        return data;
    }

    @DataProvider(name = "validLoginData")
    public Object[][] getValidLoginData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "loginData.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        // Filter only valid login data (you can add a flag in JSON)
        JSONObject validLogin = (JSONObject) loginArray.get(0);

        LoginRequest loginRequest = new LoginRequest();
        loginRequest.setEmail((String) validLogin.get("email"));
        loginRequest.setPassword((String) validLogin.get("password"));
        loginRequest.setRole((String) validLogin.get("role"));

        return new Object[][]{{loginRequest}};
    }

    @DataProvider(name = "loginInvalidTestData")
    public Object[][] getLoginInvalidTestData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "invalidLoginData.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        Object[][] data = new Object[loginArray.size()][1];

        for (int i = 0; i < loginArray.size(); i++) {
            JSONObject loginObj = (JSONObject) loginArray.get(i);

            LoginRequest loginRequest = new LoginRequest();
            loginRequest.setEmail((String) loginObj.get("email"));
            loginRequest.setPassword((String) loginObj.get("password"));
            loginRequest.setRole((String) loginObj.get("role"));

            data[i][0] = loginRequest;
        }

        return data;
    }

    @DataProvider(name = "LoginMissingFieldsTestData")
    public Object[][] getLoginMissingFieldsTestData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "loginDataWithMissingFields.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        Object[][] data = new Object[loginArray.size()][1];

        for (int i = 0; i < loginArray.size(); i++) {
            JSONObject loginObj = (JSONObject) loginArray.get(i);

            LoginRequest loginRequest = new LoginRequest();
            loginRequest.setEmail((String) loginObj.get("email"));
            loginRequest.setPassword((String) loginObj.get("password"));
            loginRequest.setRole((String) loginObj.get("role"));

            data[i][0] = loginRequest;
        }

        return data;
    }

    @DataProvider(name = "invalidEmailFormatLoginData")
    public Object[][] getInvalidEmailFormatLoginData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "invalidEmailFormat.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        // Filter only valid login data (you can add a flag in JSON)
        JSONObject validLogin = (JSONObject) loginArray.get(0);

        LoginRequest loginRequest = new LoginRequest();
        loginRequest.setEmail((String) validLogin.get("email"));
        loginRequest.setPassword((String) validLogin.get("password"));
        loginRequest.setRole((String) validLogin.get("role"));

        return new Object[][]{{loginRequest}};
    }

    @DataProvider(name = "EmptyJsonLoginData")
    public Object[][] getEmptyJsonLoginData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "emptyBody.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        // Filter only valid login data (you can add a flag in JSON)
        JSONObject validLogin = (JSONObject) loginArray.get(0);

        LoginRequest loginRequest = new LoginRequest();
        loginRequest.setEmail((String) validLogin.get("email"));
        loginRequest.setPassword((String) validLogin.get("password"));
        loginRequest.setRole((String) validLogin.get("role"));

        return new Object[][]{{loginRequest}};
    }


    @DataProvider(name = "LoginJsonWithVeryLoginData")
    public Object[][] getLoginJsonWithVeryLoginData() {
        String filePath = ConfigReader.getLoginTestDataPath() + "longEmailAndPasswordData.json";
        JSONArray loginArray = JsonUtils.readJsonArray(filePath);

        // Filter only valid login data (you can add a flag in JSON)
        JSONObject validLogin = (JSONObject) loginArray.get(0);

        LoginRequest loginRequest = new LoginRequest();
        loginRequest.setEmail((String) validLogin.get("email"));
        loginRequest.setPassword((String) validLogin.get("password"));
        loginRequest.setRole((String) validLogin.get("role"));

        return new Object[][]{{loginRequest}};
    }

}

---

### FILE: src\test\java\com\weavers\dataprovider\RegisterANewUserAPI\registerANewUserApiTestDataProvider.java
package com.weavers.dataprovider.RegisterANewUserAPI;

import com.weavers.config.ConfigReader;
import com.weavers.pojo.RegisterANewUserAPI.request.RegisterANewUserRequest;
import com.weavers.utils.JsonUtils;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.testng.annotations.DataProvider;

public class registerANewUserApiTestDataProvider {

    @DataProvider(name = "validRegisterANewUserData")
    public Object[][] getValidRegisterANewUserData() {
        String filePath = ConfigReader.getRegisterANewUserTestDataPath() + "RegisterANewUserData.json";
        System.out.println(filePath);
        JSONArray registerANewUserArray = JsonUtils.readJsonArray(filePath);

        // Filter only valid register a new user data (you can add a flag in JSON)
        JSONObject validLogin = (JSONObject) registerANewUserArray.get(0);

        RegisterANewUserRequest registerANewUserRequest = new RegisterANewUserRequest();
        registerANewUserRequest.setFullName((String) validLogin.get("fullName"));
        registerANewUserRequest.setEmail((String) validLogin.get("email"));
        registerANewUserRequest.setPassword((String) validLogin.get("password"));
        registerANewUserRequest.setConfirmPassword((String) validLogin.get("confirmPassword"));
        registerANewUserRequest.setToken((String) validLogin.get("token"));
        registerANewUserRequest.setRole((String) validLogin.get("role"));
        return new Object[][]{{registerANewUserRequest}};
    }
}

---

### FILE: src\test\java\com\weavers\dataprovider\RequestOTPAPI\requestOTPApiTestDataProvider.java
package com.weavers.dataprovider.RequestOTPAPI;

import com.weavers.config.ConfigReader;
import com.weavers.pojo.RequestOTPAPI.request.RequestOTPRequest;
import com.weavers.utils.JsonUtils;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.testng.annotations.DataProvider;

public class requestOTPApiTestDataProvider {

    @DataProvider(name = "validRequestOTPData")
    public Object[][] getValidRequestOTPData() {
        String filePath = ConfigReader.getRequestOTPDataPath() + "RequestOTPData.json";
        System.out.println("Reading Request OTP test data from: " + filePath);
        JSONArray requestOTPArray = JsonUtils.readJsonArray(filePath);
        JSONObject validOtp = (JSONObject) requestOTPArray.get(0);

        RequestOTPRequest requestOTPRequest = new RequestOTPRequest();
        requestOTPRequest.setEmail((String) validOtp.get("email"));

        return new Object[][]{{requestOTPRequest}};
    }
}

---

### FILE: src\test\java\com\weavers\tests\LoginTest.java
package com.weavers.tests;

import com.weavers.base.BaseTest;
import com.weavers.dataprovider.LoginAPI.loginApiTestDataProvider;
import com.weavers.pojo.LoginAPI.request.LoginRequest;
import com.weavers.pojo.LoginAPI.response.LoginResponse;
import com.weavers.services.AuthService;
import com.weavers.utils.MyRetry;
import io.qameta.allure.*;
import io.restassured.response.Response;
import org.testng.Assert;
import org.testng.annotations.Test;

@Epic("Authentication")
@Feature("Login API")
public class LoginTest extends BaseTest {
    @Story("Successful Login Flow")
    @Severity(SeverityLevel.BLOCKER)
    @Description("Validates successful login with valid credentials and verifies response structure including user data and JWT tokens")
    @TmsLink("TC-LOGIN-001")
    @Issue("AUTH-123")
    @Test(description = "Validating the Response data", dataProvider = "validLoginData", dataProviderClass = loginApiTestDataProvider.class, priority = 1, retryAnalyzer = MyRetry.class)
    public void testLoginSuccess(LoginRequest loginRequest) {
        try{
            System.out.println("Testing Login with: " + loginRequest);
            Response response = AuthService.login(loginRequest);
            // Assertions
            Assert.assertEquals(response.getStatusCode(), 200, "Status code should be 200");
            LoginResponse loginResponse = response.as(LoginResponse.class);
            Assert.assertEquals(loginResponse.getCode(), 200, "Response code should be 200");
            Assert.assertEquals(loginResponse.getMessage(), "Login successfully", "Message mismatch");
            Assert.assertNotNull(loginResponse.getData(), "Data should not be null");
            Assert.assertNotNull(loginResponse.getData().getUser(), "User should not be null");
            Assert.assertNotNull(loginResponse.getData().getToken(), "Token should not be null");
            Assert.assertEquals(loginResponse.getData().getUser().getEmail(), loginRequest.getEmail(), "Email mismatch");
            Assert.assertTrue(loginResponse.getData().getUser().isVerified(), "User should be verified");
            Assert.assertNotNull(loginResponse.getData().getToken().getAccess(), "Access token should not be null");
            Assert.assertNotNull(loginResponse.getData().getToken().getRefresh(), "Refresh token should not be null");
            Assert.assertTrue(loginResponse.getData().getToken().getAccess().matches("^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+$"));
            Assert.assertTrue(loginResponse.getData().getToken().getAccess().matches("^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+$"));
            System.out.println("✓ Login Test Passed Successfully!");
            System.out.println("Access Token: " + loginResponse.getData().getToken().getAccess());
            System.out.println("Refresh Token: " + loginResponse.getData().getToken().getRefresh());
        }catch (Exception e){
            throw new RuntimeException(e);
        }
    }

    @Test(description = "Test token allows access to protected endpoint", dataProvider = "loginData", dataProviderClass = loginApiTestDataProvider.class, priority = 2, retryAnalyzer = MyRetry.class)
    public void testLoginWithAllData(LoginRequest loginRequest) {
        System.out.println("Testing Login with: " + loginRequest);
        Response response = AuthService.wrongMethodLogin();
        System.out.println("Response Status Code: " + response.getStatusCode());
        System.out.println("Response Body: " + response.getBody().asString());
        // Basic validation
        Assert.assertTrue(response.getStatusCode() == 200 || response.getStatusCode() == 404, "Status code should be 200 or 404");
        if (response.getStatusCode() == 200) {
            LoginResponse loginResponse = response.as(LoginResponse.class);
            Assert.assertEquals(loginResponse.getCode(), 200, "Response code should be 200");
            Assert.assertEquals(loginResponse.getMessage(), "Login successfully", "Message mismatch");
            Assert.assertNotNull(loginResponse.getData(), "Data should not be null");
            Assert.assertNotNull(loginResponse.getData().getUser(), "User should not be null");
            Assert.assertNotNull(loginResponse.getData().getToken(), "Token should not be null");
            Assert.assertEquals(loginResponse.getData().getUser().getEmail(), loginRequest.getEmail(), "Email mismatch");
            Assert.assertTrue(loginResponse.getData().getUser().isVerified(), "User should be verified");
            Assert.assertNotNull(loginResponse.getData().getToken().getAccess(), "Access token should not be null");
            Assert.assertNotNull(loginResponse.getData().getToken().getRefresh(), "Refresh token should not be null");
            Assert.assertTrue(loginResponse.getData().getToken().getAccess().matches("^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+$"));
            Assert.assertTrue(loginResponse.getData().getToken().getAccess().matches("^[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+\\.[A-Za-z0-9-_]+$"));
            System.out.println("✓ Login Test Passed Successfully!");
            System.out.println("Access Token: " + loginResponse.getData().getToken().getAccess());
            System.out.println("Refresh Token: " + loginResponse.getData().getToken().getRefresh());
        } else if (response.getStatusCode() == 404) {
            System.out.println("No data found for this endpoint — valid 404 case.");
        }
    }

    @Test(description = "Verify login is rejected for invalid combinations of email, password, and role", dataProvider = "loginInvalidTestData", dataProviderClass = loginApiTestDataProvider.class, priority = 3, retryAnalyzer = MyRetry.class)
    public void testShouldNotAllowLoginWithInvalidCredentials(LoginRequest loginRequest) {
        try {
            System.out.println("Testing Login with: " + loginRequest);
            Response response = AuthService.login(loginRequest);
            Assert.assertEquals(response.getStatusCode(), 400, "Status code should be 400 or 401 or 403");
        } catch (Exception e) {
            System.err.println("Exception during login with invalid credentials: " + e.getMessage());
        }
    }

    @Test(description = "Verify login is rejected for missing email field", dataProvider = "LoginMissingFieldsTestData", dataProviderClass = loginApiTestDataProvider.class, priority = 4, retryAnalyzer = MyRetry.class)
    public void testShouldNotAllowLoginWithMissingEmail(LoginRequest loginRequest) {
        try {
            System.out.println("Testing Login with: " + loginRequest);
            Response response = AuthService.login(loginRequest);
            Assert.assertEquals(response.getStatusCode(), 400, "Status code should be 400 or 401 or 403");
        } catch (Exception e) {
            System.err.println("Exception during login with missing email: " + e.getMessage());
        }
    }

    @Test(description = "Verify login is rejected for invalid email format", dataProvider = "invalidEmailFormatLoginData", dataProviderClass = loginApiTestDataProvider.class, priority = 5, retryAnalyzer = MyRetry.class)
    public void testLoginInvalidFormat(LoginRequest loginRequest) {
        try {
            System.out.println("Testing Login with: " + loginRequest);
            Response response = AuthService.login(loginRequest);
            Assert.assertEquals(response.getStatusCode(), 400, "Status code should be 400 or 401 or 403");
        } catch (Exception e) {
            System.err.println("Exception during login with invalid format: " + e.getMessage());
        }
    }

    @Test(description = "Verify login is rejected for unverified user", dataProvider = "EmptyJsonLoginData", dataProviderClass = loginApiTestDataProvider.class, priority = 6, retryAnalyzer = MyRetry.class)
    public void testShouldNotAllowLoginForUnverifiedUser(LoginRequest loginRequest) {
        try {
            System.out.println("Testing Login with: " + loginRequest);
            Response response = AuthService.login(loginRequest);
            Assert.assertEquals(response.getStatusCode(), 400, "Status code should be 403 for unverified user");
        } catch (Exception e) {
            System.err.println("Exception during login for unverified user: " + e.getMessage());
        }
    }

    @Test(description = "Verify login user name and password is very long", dataProvider = "LoginJsonWithVeryLoginData", dataProviderClass = loginApiTestDataProvider.class, priority = 6, retryAnalyzer = MyRetry.class)
    public void testLoginWithVeryLongEmailAndPassword(LoginRequest loginRequest) {
        try {
            System.out.println("Testing Login with: " + loginRequest);
            Response response = AuthService.login(loginRequest);
            Assert.assertEquals(response.getStatusCode(), 400, "Status code should be 403 for unverified user");
        } catch (Exception e) {
            System.err.println("Exception during login for unverified user: " + e.getMessage());
        }
    }
}

---

### FILE: src\test\java\com\weavers\tests\RegisterANewUserTest.java
package com.weavers.tests;

import com.weavers.base.BaseTest;
import com.weavers.dataprovider.RegisterANewUserAPI.registerANewUserApiTestDataProvider;
import com.weavers.pojo.RegisterANewUserAPI.request.RegisterANewUserRequest;
import com.weavers.services.AuthService;
import com.weavers.utils.MyRetry;
import io.qameta.allure.*;
import io.restassured.response.Response;
import org.testng.annotations.Test;

@Epic("Authentication")
@Feature("Register A New User API")
public class RegisterANewUserTest extends BaseTest {
    @Story("Successful Register A New User Flow")
    @Severity(SeverityLevel.BLOCKER)
    @Description("This test case validates the Register A New User API with valid data")
    @TmsLink("TC-LOGIN-001")
    @Issue("AUTH-123")
    @Test(description = "Validating the Response data", dataProvider = "validRegisterANewUserData", dataProviderClass = registerANewUserApiTestDataProvider.class, priority = 1, retryAnalyzer = MyRetry.class)
    public void testRegisterANewUser(RegisterANewUserRequest registerANewUserRequest) {
        try {
            System.out.println("Testing Login with: " + registerANewUserRequest);
            Response response = AuthService.registerNewUser(registerANewUserRequest);
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }
}

---

### FILE: src\test\java\com\weavers\tests\RequestOTPTest.java
package com.weavers.tests;

import com.weavers.base.BaseTest;
import com.weavers.dataprovider.RequestOTPAPI.requestOTPApiTestDataProvider;
import com.weavers.pojo.RequestOTPAPI.request.RequestOTPRequest;
import com.weavers.pojo.RequestOTPAPI.response.RequestOTPResponse;
import com.weavers.services.AuthService;
import com.weavers.utils.MyRetry;
import io.qameta.allure.*;
import io.restassured.response.Response;
import org.testng.Assert;
import org.testng.annotations.Test;

@Epic("Authentication")
@Feature("Request OTP API")
public class RequestOTPTest extends BaseTest {
    @Story("Successful Request OTP Test Flow")
    @Severity(SeverityLevel.BLOCKER)
    @Description("This test case validates the Request OTP API with valid data")
    @TmsLink("TC-REQOTP-001")
    @Issue("AUTH-256")
    @Test(description = "Validating the Request OTP data", dataProvider = "validRequestOTPData", dataProviderClass = requestOTPApiTestDataProvider.class, priority = 1, retryAnalyzer = MyRetry.class)
    public void testRequestOTP(RequestOTPRequest requestOTPRequest) {
       System.out.println("Testing Login with: " + requestOTPRequest);
        Response response = AuthService.requestOTP(requestOTPRequest);

        Assert.assertEquals(response.getStatusCode(), 200);

        RequestOTPResponse requestOTPResponse = response.as(RequestOTPResponse.class);
        Assert.assertEquals(requestOTPResponse.getCode(), 200, "Response code should be 200");
        Assert.assertEquals(requestOTPResponse.getMessage(), "OTP sent successfully", "Message mismatch");
        Assert.assertTrue(requestOTPResponse.isData(), "Data field should be true");
    }
}

---

